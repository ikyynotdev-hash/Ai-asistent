<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Chat</title>
  <style>
    body { background:#0c0c14; font-family:sans-serif; color:#fff; margin:0; }
    .wrap { max-width:900px; margin:20px auto; padding:20px; }
    #messages { height:450px; overflow-y:auto; background:#14141f; padding:15px; border-radius:10px; }
    .msg { padding:10px; margin:8px 0; border-radius:8px; max-width:75%; }
    .user { background:#242439; margin-left:auto; }
    .bot { background:#1a1a26; }
    .row { display:flex; gap:10px; margin-top:15px; }
    textarea { flex:1; padding:10px; border-radius:10px; background:#0f0f18; color:#fff; border:none; resize:none; }
    button { padding:10px 14px; border-radius:10px; border:none; font-weight:bold; background:#6d4bff; color:#fff; cursor:pointer; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>AI Chat</h1>
    <div id="messages"></div>

    <div class="row">
      <textarea id="input" placeholder="Ketik pesan..."></textarea>
      <button onclick="send()">Send</button>
    </div>
  </div>

<script>
const API_BASE = "/api/chat";

function add(role, text){
  const el = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "msg " + role;
  div.innerText = text;
  el.appendChild(div);
  el.scrollTop = el.scrollHeight;
}

async function send(){
  const text = document.getElementById("input").value.trim();
  if(!text) return;
  add("user", text);
  document.getElementById("input").value = ""

  add("bot", "Thinking...")

  try {
    const r = await fetch(API_BASE, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({
        messages: [
          { role:"user", content:text }
        ]
      })
    });

    const data = await r.json();
    document.querySelectorAll(".bot").pop().remove();

    add("bot", data.choices?.[0]?.message?.content || "error");
  } catch(err){
    add("bot", "Network error: " + err);
  }
}
</script>
</body>
</html>
